{# WITH granular AS (

  SELECT * 
  FROM {{ ref('mart_crm_opportunity_7th_day_weekly_snapshot')}}

),

aggregate AS (

  SELECT * 
  FROM {{ ref('mart_crm_opportunity_7th_day_weekly_snapshot_aggregate')}}

),

targets_actuals AS (

  SELECT * 
  FROM {{ ref('mart_targets_actuals_7th_day_weekly_snapshot')}}

),

unioned AS (

  SELECT 
    granular.*,
    NULL AS total_quarter_target,
    NULL AS coverage_booked_net_arr,
    NULL AS coverage_open_1plus_net_arr,
    NULL AS coverage_open_3plus_net_arr,
    NULL AS coverage_open_4plus_net_arr,
    NULL AS total_booked_net_arr
  FROM granular
  WHERE is_current_snapshot_quarter

  UNION 

  SELECT 
    NULL AS crm_opportunity_snapshot_id,
    NULL AS snapshot_id,
    NULL AS dim_crm_opportunity_id,
    NULL AS dim_parent_crm_account_id,
    NULL AS dim_crm_account_id,
    NULL AS dim_crm_user_id,
    NULL AS dim_parent_crm_opportunity_id,
    NULL AS duplicate_opportunity_id,
    NULL AS merged_opportunity_id,
    NULL AS dim_crm_user_hierarchy_account_user_sk,
    NULL AS opportunity_name,
    NULL AS stage_name,
    NULL AS reason_for_loss,
    NULL AS reason_for_loss_details,
    NULL AS reason_for_loss_staged,
    NULL AS reason_for_loss_calc,
    NULL AS risk_type,
    NULL AS risk_reasons,
    NULL AS downgrade_reason,
    NULL AS downgrade_details,
    NULL AS sales_type,
    NULL AS deal_path_name,
    NULL AS order_type,
    NULL AS order_type_grouped,
    NULL AS order_type_live,
    NULL AS dr_partner_engagement_name,
    NULL AS alliance_type_name,
    NULL AS alliance_type_short_name,
    NULL AS channel_type_name,
    NULL AS sales_qualified_source_name,
    NULL AS sales_qualified_source_grouped,
    NULL AS sqs_bucket_engagement,
    NULL AS closed_buckets,
    NULL AS opportunity_category,
    NULL AS source_buckets,
    NULL AS opportunity_sales_development_representative,
    NULL AS opportunity_business_development_representative,
    NULL AS opportunity_development_representative,
    NULL AS sdr_or_bdr,
    NULL AS iqm_submitted_by_role,
    NULL AS sdr_pipeline_contribution,
    NULL AS fpa_master_bookings_flag,
    NULL AS sales_path,
    NULL AS professional_services_value,
    NULL AS primary_solution_architect,
    NULL AS product_details,
    NULL AS product_category,
    NULL AS products_purchased,
    NULL AS growth_type,
    NULL AS opportunity_deal_size,
    NULL AS deployment_preference,
    NULL AS net_new_source_categories,
    NULL AS invoice_number,
    NULL AS primary_campaign_source_id,
    NULL AS ga_client_id,
    NULL AS military_invasion_comments,
    NULL AS military_invasion_risk_scale,
    NULL AS vsa_readout,
    NULL AS vsa_start_date,
    NULL AS vsa_end_date,
    NULL AS vsa_url,
    NULL AS vsa_status,
    NULL AS intended_product_tier,
    NULL AS opportunity_term,
    NULL AS record_type_id,
    NULL AS opportunity_owner_manager,
    NULL AS opportunity_owner_department,
    NULL AS opportunity_owner_role,
    NULL AS opportunity_owner_title,
    NULL AS solutions_to_be_replaced,
    NULL AS opportunity_health,
    NULL AS tam_notes,
    NULL AS generated_source,
    NULL AS churn_contraction_type,
    NULL AS churn_contraction_net_arr_bucket,
    NULL AS stage_name_3plus,
    NULL AS stage_name_4plus,
    NULL AS stage_category,
    NULL AS deal_category,
    NULL AS deal_group,
    NULL AS deal_size,
    NULL AS calculated_deal_size,
    NULL AS dr_partner_engagement,
    NULL AS deal_path_engagement,
    NULL AS forecast_category_name,
    NULL AS opportunity_owner,
    NULL AS owner_id,
    NULL AS resale_partner_name,
    NULL AS is_won,
    NULL AS is_closed,
    NULL AS is_edu_oss,
    NULL AS is_ps_opp,
    NULL AS is_sao,
    NULL AS is_win_rate_calc,
    NULL AS is_net_arr_pipeline_created,
    NULL AS is_net_arr_closed_deal,
    NULL AS is_new_logo_first_order,
    NULL AS is_closed_won,
    NULL AS is_web_portal_purchase,
    NULL AS is_stage_1_plus,
    NULL AS is_stage_3_plus,
    NULL AS is_stage_4_plus,
    NULL AS is_lost,
    NULL AS is_open,
    NULL AS is_active,
    NULL AS is_risky,
    NULL AS is_credit,
    NULL AS is_renewal,
    NULL AS is_refund,
    NULL AS is_deleted,
    NULL AS is_duplicate,
    NULL AS is_contract_reset,
    NULL AS is_comp_new_logo_override,
    NULL AS is_eligible_open_pipeline,
    NULL AS is_eligible_asp_analysis,
    NULL AS is_eligible_age_analysis,
    NULL AS is_eligible_churn_contraction,
    NULL AS is_booked_net_arr,
    NULL AS is_downgrade,
    NULL AS is_excluded_from_pipeline_created,
    NULL AS critical_deal_flag,
    NULL AS crm_account_name,
    NULL AS parent_crm_account_name,
    NULL AS parent_crm_account_business_unit,
    NULL AS parent_crm_account_sales_segment,
    NULL AS parent_crm_account_geo,
    NULL AS parent_crm_account_region,
    NULL AS parent_crm_account_area,
    NULL AS parent_crm_account_territory,
    NULL AS parent_crm_account_role_type,
    NULL AS parent_crm_account_max_family_employee,
    NULL AS parent_crm_account_upa_country,
    NULL AS parent_crm_account_upa_state,
    NULL AS parent_crm_account_upa_city,
    NULL AS parent_crm_account_upa_street,
    NULL AS parent_crm_account_upa_postal_code,
    NULL AS crm_account_employee_count,
    NULL AS crm_account_gtm_strategy,
    NULL AS crm_account_focus_account,
    NULL AS crm_account_zi_technologies,
    NULL AS is_jihu_account,
    NULL AS sao_crm_opp_owner_sales_segment_stamped,
    NULL AS sao_crm_opp_owner_sales_segment_stamped_grouped,
    NULL AS sao_crm_opp_owner_geo_stamped,
    NULL AS sao_crm_opp_owner_region_stamped,
    NULL AS sao_crm_opp_owner_area_stamped,
    NULL AS sao_crm_opp_owner_segment_region_stamped_grouped,
    NULL AS sao_crm_opp_owner_sales_segment_geo_region_area_stamped,
    NULL AS crm_opp_owner_stamped_name,
    NULL AS crm_account_owner_stamped_name,
    NULL AS crm_opp_owner_sales_segment_stamped,
    NULL AS crm_opp_owner_sales_segment_stamped_grouped,
    NULL AS crm_opp_owner_geo_stamped,
    NULL AS crm_opp_owner_region_stamped,
    NULL AS crm_opp_owner_area_stamped,
    NULL AS crm_opp_owner_business_unit_stamped,
    NULL AS crm_opp_owner_sales_segment_region_stamped_grouped,
    NULL AS crm_opp_owner_sales_segment_geo_region_area_stamped,
    NULL AS crm_opp_owner_user_role_type_stamped,
    NULL AS crm_user_sales_segment,
    NULL AS crm_user_sales_segment_grouped,
    NULL AS crm_user_geo,
    NULL AS crm_user_region,
    NULL AS crm_user_area,
    NULL AS crm_user_business_unit,
    NULL AS crm_user_sales_segment_region_grouped,
    NULL AS crm_account_user_sales_segment,
    NULL AS crm_account_user_sales_segment_grouped,
    NULL AS crm_account_user_geo,
    NULL AS crm_account_user_region,
    NULL AS crm_account_user_area,
    NULL AS crm_account_user_sales_segment_region_grouped,
    NULL AS dim_crm_current_account_set_sales_segment,
    NULL AS dim_crm_current_account_set_geo,
    NULL AS dim_crm_current_account_set_region,
    NULL AS dim_crm_current_account_set_area,
    NULL AS dim_crm_current_account_set_business_unit,
    NULL AS dim_crm_current_account_set_role_name,
    NULL AS dim_crm_current_account_set_role_level_1,
    NULL AS dim_crm_current_account_set_role_level_2,
    NULL AS dim_crm_current_account_set_role_level_3,
    NULL AS dim_crm_current_account_set_role_level_4,
    NULL AS dim_crm_current_account_set_role_level_5,
    NULL AS opportunity_owner_user_segment,
    NULL AS opportunity_owner_user_geo,
    NULL AS opportunity_owner_user_region,
    NULL AS opportunity_owner_user_area,
    NULL AS report_opportunity_user_segment,
    NULL AS report_opportunity_user_geo,
    NULL AS report_opportunity_user_region,
    NULL AS report_opportunity_user_area,
    NULL AS report_user_segment_geo_region_area,
    NULL AS report_user_segment_geo_region_area_sqs_ot,
    NULL AS key_segment,
    NULL AS key_sqs,
    NULL AS key_ot,
    NULL AS key_segment_sqs,
    NULL AS key_segment_ot,
    NULL AS key_segment_geo,
    NULL AS key_segment_geo_sqs,
    NULL AS key_segment_geo_ot,
    NULL AS key_segment_geo_region,
    NULL AS key_segment_geo_region_sqs,
    NULL AS key_segment_geo_region_ot,
    NULL AS key_segment_geo_region_area,
    NULL AS key_segment_geo_region_area_sqs,
    NULL AS key_segment_geo_region_area_ot,
    NULL AS key_segment_geo_area,
    NULL AS sales_team_cro_level,
    NULL AS sales_team_rd_asm_level,
    NULL AS sales_team_vp_level,
    NULL AS sales_team_avp_rd_level,
    NULL AS sales_team_asm_level,
    NULL AS account_owner_user_segment,
    NULL AS account_owner_user_geo,
    NULL AS account_owner_user_region,
    NULL AS account_owner_user_area,
    NULL AS lead_source,
    NULL AS dr_partner_deal_type,
    NULL AS partner_account,
    NULL AS partner_account_name,
    NULL AS partner_gitlab_program,
    NULL AS calculated_partner_track,
    NULL AS dr_status,
    NULL AS distributor,
    NULL AS dr_deal_id,
    NULL AS dr_primary_registration,
    NULL AS influence_partner,
    NULL AS fulfillment_partner,
    NULL AS fulfillment_partner_name,
    NULL AS platform_partner,
    NULL AS partner_track,
    NULL AS resale_partner_track,
    NULL AS is_public_sector_opp,
    NULL AS is_registration_from_portal,
    NULL AS calculated_discount,
    NULL AS partner_discount,
    NULL AS partner_discount_calc,
    NULL AS comp_channel_neutral,
    NULL AS count_crm_attribution_touchpoints,
    NULL AS weighted_linear_iacv,
    NULL AS count_campaigns,
    NULL AS sa_tech_evaluation_close_status,
    NULL AS sa_tech_evaluation_end_date,
    NULL AS sa_tech_evaluation_start_date,
    NULL AS cp_partner,
    NULL AS cp_paper_process,
    NULL AS cp_help,
    NULL AS cp_review_notes,
    NULL AS cp_champion,
    NULL AS cp_close_plan,
    NULL AS cp_decision_criteria,
    NULL AS cp_decision_process,
    NULL AS cp_economic_buyer,
    NULL AS cp_identify_pain,
    NULL AS cp_metrics,
    NULL AS cp_risks,
    NULL AS cp_value_driver,
    NULL AS cp_why_do_anything_at_all,
    NULL AS cp_why_gitlab,
    NULL AS cp_why_now,
    NULL AS cp_score,
    NULL AS cp_use_cases,
    NULL AS competitors,
    NULL AS competitors_other_flag,
    NULL AS competitors_gitlab_core_flag,
    NULL AS competitors_none_flag,
    NULL AS competitors_github_enterprise_flag,
    NULL AS competitors_bitbucket_server_flag,
    NULL AS competitors_unknown_flag,
    NULL AS competitors_github_flag,
    NULL AS competitors_gitlab_flag,
    NULL AS competitors_jenkins_flag,
    NULL AS competitors_azure_devops_flag,
    NULL AS competitors_svn_flag,
    NULL AS competitors_bitbucket_flag,
    NULL AS competitors_atlassian_flag,
    NULL AS competitors_perforce_flag,
    NULL AS competitors_visual_studio_flag,
    NULL AS competitors_azure_flag,
    NULL AS competitors_amazon_code_commit_flag,
    NULL AS competitors_circleci_flag,
    NULL AS competitors_bamboo_flag,
    NULL AS competitors_aws_flag,
    NULL AS created_date,
    NULL AS created_month,
    NULL AS created_fiscal_quarter_date,
    NULL AS created_fiscal_quarter_name,
    NULL AS created_fiscal_year,
    NULL AS sales_accepted_date,
    NULL AS sales_accepted_month,
    NULL AS sales_accepted_fiscal_quarter_date,
    NULL AS sales_accepted_fiscal_quarter_name,
    NULL AS sales_accepted_fiscal_year,
    NULL AS close_date,
    NULL AS close_month,
    NULL AS close_fiscal_quarter_date,
    NULL AS close_fiscal_quarter_name,
    NULL AS close_fiscal_year,
    NULL AS stage_0_pending_acceptance_date,
    NULL AS stage_0_pending_acceptance_month,
    NULL AS stage_0_pending_acceptance_fiscal_quarter_date,
    NULL AS stage_0_pending_acceptance_fiscal_quarter_name,
    NULL AS stage_0_pending_acceptance_fiscal_year,
    NULL AS stage_1_discovery_date,
    NULL AS stage_1_discovery_month,
    NULL AS stage_1_discovery_fiscal_quarter_date,
    NULL AS stage_1_discovery_fiscal_quarter_name,
    NULL AS stage_1_discovery_fiscal_year,
    NULL AS stage_2_scoping_date,
    NULL AS stage_2_scoping_month,
    NULL AS stage_2_scoping_fiscal_quarter_date,
    NULL AS stage_2_scoping_fiscal_quarter_name,
    NULL AS stage_2_scoping_fiscal_year,
    NULL AS stage_3_technical_evaluation_date,
    NULL AS stage_3_technical_evaluation_month,
    NULL AS stage_3_technical_evaluation_fiscal_quarter_date,
    NULL AS stage_3_technical_evaluation_fiscal_quarter_name,
    NULL AS stage_3_technical_evaluation_fiscal_year,
    NULL AS stage_4_proposal_date,
    NULL AS stage_4_proposal_month,
    NULL AS stage_4_proposal_fiscal_quarter_date,
    NULL AS stage_4_proposal_fiscal_quarter_name,
    NULL AS stage_4_proposal_fiscal_year,
    NULL AS stage_5_negotiating_date,
    NULL AS stage_5_negotiating_month,
    NULL AS stage_5_negotiating_fiscal_quarter_date,
    NULL AS stage_5_negotiating_fiscal_quarter_name,
    NULL AS stage_5_negotiating_fiscal_year,
    NULL AS stage_6_awaiting_signature_date,
    NULL AS stage_6_awaiting_signature_date_date,
    NULL AS stage_6_awaiting_signature_date_month,
    NULL AS stage_6_awaiting_signature_date_fiscal_quarter_date,
    NULL AS stage_6_awaiting_signature_date_fiscal_quarter_name,
    NULL AS stage_6_awaiting_signature_date_fiscal_year,
    NULL AS stage_6_closed_won_date,
    NULL AS stage_6_closed_won_month,
    NULL AS stage_6_closed_won_fiscal_quarter_date,
    NULL AS stage_6_closed_won_fiscal_quarter_name,
    NULL AS stage_6_closed_won_fiscal_year,
    NULL AS stage_6_closed_lost_date,
    NULL AS stage_6_closed_lost_month,
    NULL AS stage_6_closed_lost_fiscal_quarter_date,
    NULL AS stage_6_closed_lost_fiscal_quarter_name,
    NULL AS stage_6_closed_lost_fiscal_year,
    NULL AS subscription_start_date,
    NULL AS subscription_start_month,
    NULL AS subscription_start_fiscal_quarter_date,
    NULL AS subscription_start_fiscal_quarter_name,
    NULL AS subscription_start_fiscal_year,
    NULL AS subscription_end_date,
    NULL AS subscription_end_month,
    NULL AS subscription_end_fiscal_quarter_date,
    NULL AS subscription_end_fiscal_quarter_name,
    NULL AS subscription_end_fiscal_year,
    NULL AS sales_qualified_date,
    NULL AS sales_qualified_month,
    NULL AS sales_qualified_fiscal_quarter_date,
    NULL AS sales_qualified_fiscal_quarter_name,
    NULL AS sales_qualified_fiscal_year,
    NULL AS last_activity_date,
    NULL AS last_activity_month,
    NULL AS last_activity_fiscal_quarter_date,
    NULL AS last_activity_fiscal_quarter_name,
    NULL AS last_activity_fiscal_year,
    NULL AS sales_last_activity_date,
    NULL AS sales_last_activity_month,
    NULL AS sales_last_activity_fiscal_quarter_date,
    NULL AS sales_last_activity_fiscal_quarter_name,
    NULL AS sales_last_activity_fiscal_year,
    NULL AS technical_evaluation_date,
    NULL AS technical_evaluation_month,
    NULL AS technical_evaluation_fiscal_quarter_date,
    NULL AS technical_evaluation_fiscal_quarter_name,
    NULL AS technical_evaluation_fiscal_year,
    NULL AS arr_created_date,
    NULL AS arr_created_month,
    NULL AS arr_created_fiscal_quarter_date,
    NULL AS arr_created_fiscal_quarter_name,
    NULL AS arr_created_fiscal_year,
    NULL AS pipeline_created_date,
    NULL AS pipeline_created_month,
    NULL AS pipeline_created_fiscal_quarter_date,
    NULL AS pipeline_created_fiscal_quarter_name,
    NULL AS pipeline_created_fiscal_year,
    NULL AS net_arr_created_date,
    NULL AS net_arr_created_month,
    NULL AS net_arr_created_fiscal_quarter_date,
    NULL AS net_arr_created_fiscal_quarter_name,
    NULL AS net_arr_created_fiscal_year,
    NULL AS snapshot_date,
    NULL AS snapshot_month,
    NULL AS snapshot_fiscal_year,
    NULL AS snapshot_fiscal_quarter_name,
    NULL AS snapshot_fiscal_quarter_date,
    NULL AS snapshot_day_of_fiscal_quarter_normalised,
    NULL AS snapshot_day_of_fiscal_year_normalised,
    NULL AS days_in_0_pending_acceptance,
    NULL AS days_in_1_discovery,
    NULL AS days_in_2_scoping,
    NULL AS days_in_3_technical_evaluation,
    NULL AS days_in_4_proposal,
    NULL AS days_in_5_negotiating,
    NULL AS days_in_sao,
    NULL AS calculated_age_in_days,
    NULL AS days_since_last_activity,
    NULL AS positive_booked_deal_count_in_snapshot_quarter,
    NULL AS positive_booked_net_arr_in_snapshot_quarter,
    NULL AS positive_open_deal_count_in_snapshot_quarter,
    NULL AS positive_open_net_arr_in_snapshot_quarter,
    NULL AS open_1plus_net_arr_in_snapshot_quarter,
    NULL AS open_3plus_net_arr_in_snapshot_quarter,
    NULL AS open_4plus_net_arr_in_snapshot_quarter,
    NULL AS open_1plus_deal_count_in_snapshot_quarter,
    NULL AS open_3plus_deal_count_in_snapshot_quarter,
    NULL AS open_4plus_deal_count_in_snapshot_quarter,
    NULL AS created_arr_in_snapshot_quarter,
    NULL AS closed_won_opps_in_snapshot_quarter,
    NULL AS closed_opps_in_snapshot_quarter,
    NULL AS closed_net_arr_in_snapshot_quarter,
    NULL AS booked_net_arr_in_snapshot_quarter,
    NULL AS created_deals_in_snapshot_quarter,
    NULL AS cycle_time_in_days_in_snapshot_quarter,
    NULL AS booked_deal_count_in_snapshot_quarter,
    NULL AS arr_basis,
    NULL AS opportunity_based_iacv_to_net_arr_ratio,
    NULL AS segment_order_type_iacv_to_net_arr_ratio,
    NULL AS calculated_from_ratio_net_arr,
    NULL AS net_arr,
    NULL AS xdr_net_arr_stage_1,
    NULL AS xdr_net_arr_stage_3,
    NULL AS created_and_won_same_quarter_net_arr,
    NULL AS new_logo_count,
    NULL AS amount,
    NULL AS open_1plus_deal_count,
    NULL AS open_3plus_deal_count,
    NULL AS open_4plus_deal_count,
    NULL AS booked_deal_count,
    NULL AS churned_contraction_deal_count,
    NULL AS open_1plus_net_arr,
    NULL AS open_3plus_net_arr,
    NULL AS open_4plus_net_arr,
    NULL AS booked_net_arr,
    NULL AS churned_contraction_net_arr,
    NULL AS calculated_deal_count,
    NULL AS booked_churned_contraction_deal_count,
    NULL AS booked_churned_contraction_net_arr,
    NULL AS raw_net_arr,
    NULL AS arr,
    NULL AS recurring_amount,
    NULL AS true_up_amount,
    NULL AS proserv_amount,
    NULL AS other_non_recurring_amount,
    NULL AS renewal_amount,
    NULL AS total_contract_value,
    NULL AS created_in_snapshot_quarter_net_arr,
    NULL AS created_in_snapshot_quarter_deal_count,
    NULL AS days_in_stage,
    NULL AS pre_military_invasion_arr,
    NULL AS vsa_start_date_net_arr,
    NULL AS won_arr_basis_for_clari,
    NULL AS arr_basis_for_clari,
    NULL AS net_incremental_acv,
    NULL AS incremental_acv,
    NULL AS forecasted_churn_for_clari,
    NULL AS override_arr_basis_clari,
    NULL AS cycle_time_in_days,
    NULL AS ptc_predicted_arr,
    NULL AS ptc_predicted_renewal_risk_category
  FROM aggregate

  UNION 

  SELECT
    NULL AS crm_opportunity_snapshot_id,
    NULL AS snapshot_id,
    NULL AS dim_crm_opportunity_id,
    NULL AS dim_parent_crm_account_id,
    NULL AS dim_crm_account_id,
    NULL AS dim_crm_user_id,
    NULL AS dim_parent_crm_opportunity_id,
    NULL AS duplicate_opportunity_id,
    NULL AS merged_opportunity_id,
    NULL AS dim_crm_user_hierarchy_account_user_sk,
    NULL AS opportunity_name,
    NULL AS stage_name,
    NULL AS reason_for_loss,
    NULL AS reason_for_loss_details,
    NULL AS reason_for_loss_staged,
    NULL AS reason_for_loss_calc,
    NULL AS risk_type,
    NULL AS risk_reasons,
    NULL AS downgrade_reason,
    NULL AS downgrade_details,
    NULL AS sales_type,
    NULL AS deal_path_name,
    NULL AS order_type,
    NULL AS order_type_grouped,
    NULL AS order_type_live,
    NULL AS dr_partner_engagement_name,
    NULL AS alliance_type_name,
    NULL AS alliance_type_short_name,
    NULL AS channel_type_name,
    NULL AS sales_qualified_source_name,
    NULL AS sales_qualified_source_grouped,
    NULL AS sqs_bucket_engagement,
    NULL AS closed_buckets,
    NULL AS opportunity_category,
    NULL AS source_buckets,
    NULL AS opportunity_sales_development_representative,
    NULL AS opportunity_business_development_representative,
    NULL AS opportunity_development_representative,
    NULL AS sdr_or_bdr,
    NULL AS iqm_submitted_by_role,
    NULL AS sdr_pipeline_contribution,
    NULL AS fpa_master_bookings_flag,
    NULL AS sales_path,
    NULL AS professional_services_value,
    NULL AS primary_solution_architect,
    NULL AS product_details,
    NULL AS product_category,
    NULL AS products_purchased,
    NULL AS growth_type,
    NULL AS opportunity_deal_size,
    NULL AS deployment_preference,
    NULL AS net_new_source_categories,
    NULL AS invoice_number,
    NULL AS primary_campaign_source_id,
    NULL AS ga_client_id,
    NULL AS military_invasion_comments,
    NULL AS military_invasion_risk_scale,
    NULL AS vsa_readout,
    NULL AS vsa_start_date,
    NULL AS vsa_end_date,
    NULL AS vsa_url,
    NULL AS vsa_status,
    NULL AS intended_product_tier,
    NULL AS opportunity_term,
    NULL AS record_type_id,
    NULL AS opportunity_owner_manager,
    NULL AS opportunity_owner_department,
    NULL AS opportunity_owner_role,
    NULL AS opportunity_owner_title,
    NULL AS solutions_to_be_replaced,
    NULL AS opportunity_health,
    NULL AS tam_notes,
    NULL AS generated_source,
    NULL AS churn_contraction_type,
    NULL AS churn_contraction_net_arr_bucket,
    NULL AS stage_name_3plus,
    NULL AS stage_name_4plus,
    NULL AS stage_category,
    NULL AS deal_category,
    NULL AS deal_group,
    NULL AS deal_size,
    NULL AS calculated_deal_size,
    NULL AS dr_partner_engagement,
    NULL AS deal_path_engagement,
    NULL AS forecast_category_name,
    NULL AS opportunity_owner,
    NULL AS owner_id,
    NULL AS resale_partner_name,
    NULL AS is_won,
    NULL AS is_closed,
    NULL AS is_edu_oss,
    NULL AS is_ps_opp,
    NULL AS is_sao,
    NULL AS is_win_rate_calc,
    NULL AS is_net_arr_pipeline_created,
    NULL AS is_net_arr_closed_deal,
    NULL AS is_new_logo_first_order,
    NULL AS is_closed_won,
    NULL AS is_web_portal_purchase,
    NULL AS is_stage_1_plus,
    NULL AS is_stage_3_plus,
    NULL AS is_stage_4_plus,
    NULL AS is_lost,
    NULL AS is_open,
    NULL AS is_active,
    NULL AS is_risky,
    NULL AS is_credit,
    NULL AS is_renewal,
    NULL AS is_refund,
    NULL AS is_deleted,
    NULL AS is_duplicate,
    NULL AS is_contract_reset,
    NULL AS is_comp_new_logo_override,
    NULL AS is_eligible_open_pipeline,
    NULL AS is_eligible_asp_analysis,
    NULL AS is_eligible_age_analysis,
    NULL AS is_eligible_churn_contraction,
    NULL AS is_booked_net_arr,
    NULL AS is_downgrade,
    NULL AS is_excluded_from_pipeline_created,
    NULL AS critical_deal_flag,
    NULL AS crm_account_name,
    NULL AS parent_crm_account_name,
    NULL AS parent_crm_account_business_unit,
    NULL AS parent_crm_account_sales_segment,
    NULL AS parent_crm_account_geo,
    NULL AS parent_crm_account_region,
    NULL AS parent_crm_account_area,
    NULL AS parent_crm_account_territory,
    NULL AS parent_crm_account_role_type,
    NULL AS parent_crm_account_max_family_employee,
    NULL AS parent_crm_account_upa_country,
    NULL AS parent_crm_account_upa_state,
    NULL AS parent_crm_account_upa_city,
    NULL AS parent_crm_account_upa_street,
    NULL AS parent_crm_account_upa_postal_code,
    NULL AS crm_account_employee_count,
    NULL AS crm_account_gtm_strategy,
    NULL AS crm_account_focus_account,
    NULL AS crm_account_zi_technologies,
    NULL AS is_jihu_account,
    NULL AS sao_crm_opp_owner_sales_segment_stamped,
    NULL AS sao_crm_opp_owner_sales_segment_stamped_grouped,
    NULL AS sao_crm_opp_owner_geo_stamped,
    NULL AS sao_crm_opp_owner_region_stamped,
    NULL AS sao_crm_opp_owner_area_stamped,
    NULL AS sao_crm_opp_owner_segment_region_stamped_grouped,
    NULL AS sao_crm_opp_owner_sales_segment_geo_region_area_stamped,
    NULL AS crm_opp_owner_stamped_name,
    NULL AS crm_account_owner_stamped_name,
    NULL AS crm_opp_owner_sales_segment_stamped,
    NULL AS crm_opp_owner_sales_segment_stamped_grouped,
    NULL AS crm_opp_owner_geo_stamped,
    NULL AS crm_opp_owner_region_stamped,
    NULL AS crm_opp_owner_area_stamped,
    NULL AS crm_opp_owner_business_unit_stamped,
    NULL AS crm_opp_owner_sales_segment_region_stamped_grouped,
    NULL AS crm_opp_owner_sales_segment_geo_region_area_stamped,
    NULL AS crm_opp_owner_user_role_type_stamped,
    NULL AS crm_user_sales_segment,
    NULL AS crm_user_sales_segment_grouped,
    NULL AS crm_user_geo,
    NULL AS crm_user_region,
    NULL AS crm_user_area,
    NULL AS crm_user_business_unit,
    NULL AS crm_user_sales_segment_region_grouped,
    NULL AS crm_account_user_sales_segment,
    NULL AS crm_account_user_sales_segment_grouped,
    NULL AS crm_account_user_geo,
    NULL AS crm_account_user_region,
    NULL AS crm_account_user_area,
    NULL AS crm_account_user_sales_segment_region_grouped,
    NULL AS dim_crm_current_account_set_sales_segment,
    NULL AS dim_crm_current_account_set_geo,
    NULL AS dim_crm_current_account_set_region,
    NULL AS dim_crm_current_account_set_area,
    NULL AS dim_crm_current_account_set_business_unit,
    NULL AS dim_crm_current_account_set_role_name,
    NULL AS dim_crm_current_account_set_role_level_1,
    NULL AS dim_crm_current_account_set_role_level_2,
    NULL AS dim_crm_current_account_set_role_level_3,
    NULL AS dim_crm_current_account_set_role_level_4,
    NULL AS dim_crm_current_account_set_role_level_5,
    NULL AS opportunity_owner_user_segment,
    NULL AS opportunity_owner_user_geo,
    NULL AS opportunity_owner_user_region,
    NULL AS opportunity_owner_user_area,
    NULL AS report_opportunity_user_segment,
    NULL AS report_opportunity_user_geo,
    NULL AS report_opportunity_user_region,
    NULL AS report_opportunity_user_area,
    NULL AS report_user_segment_geo_region_area,
    NULL AS report_user_segment_geo_region_area_sqs_ot,
    NULL AS key_segment,
    NULL AS key_sqs,
    NULL AS key_ot,
    NULL AS key_segment_sqs,
    NULL AS key_segment_ot,
    NULL AS key_segment_geo,
    NULL AS key_segment_geo_sqs,
    NULL AS key_segment_geo_ot,
    NULL AS key_segment_geo_region,
    NULL AS key_segment_geo_region_sqs,
    NULL AS key_segment_geo_region_ot,
    NULL AS key_segment_geo_region_area,
    NULL AS key_segment_geo_region_area_sqs,
    NULL AS key_segment_geo_region_area_ot,
    NULL AS key_segment_geo_area,
    NULL AS sales_team_cro_level,
    NULL AS sales_team_rd_asm_level,
    NULL AS sales_team_vp_level,
    NULL AS sales_team_avp_rd_level,
    NULL AS sales_team_asm_level,
    NULL AS account_owner_user_segment,
    NULL AS account_owner_user_geo,
    NULL AS account_owner_user_region,
    NULL AS account_owner_user_area,
    NULL AS lead_source,
    NULL AS dr_partner_deal_type,
    NULL AS partner_account,
    NULL AS partner_account_name,
    NULL AS partner_gitlab_program,
    NULL AS calculated_partner_track,
    NULL AS dr_status,
    NULL AS distributor,
    NULL AS dr_deal_id,
    NULL AS dr_primary_registration,
    NULL AS influence_partner,
    NULL AS fulfillment_partner,
    NULL AS fulfillment_partner_name,
    NULL AS platform_partner,
    NULL AS partner_track,
    NULL AS resale_partner_track,
    NULL AS is_public_sector_opp,
    NULL AS is_registration_from_portal,
    NULL AS calculated_discount,
    NULL AS partner_discount,
    NULL AS partner_discount_calc,
    NULL AS comp_channel_neutral,
    NULL AS count_crm_attribution_touchpoints,
    NULL AS weighted_linear_iacv,
    NULL AS count_campaigns,
    NULL AS sa_tech_evaluation_close_status,
    NULL AS sa_tech_evaluation_end_date,
    NULL AS sa_tech_evaluation_start_date,
    NULL AS cp_partner,
    NULL AS cp_paper_process,
    NULL AS cp_help,
    NULL AS cp_review_notes,
    NULL AS cp_champion,
    NULL AS cp_close_plan,
    NULL AS cp_decision_criteria,
    NULL AS cp_decision_process,
    NULL AS cp_economic_buyer,
    NULL AS cp_identify_pain,
    NULL AS cp_metrics,
    NULL AS cp_risks,
    NULL AS cp_value_driver,
    NULL AS cp_why_do_anything_at_all,
    NULL AS cp_why_gitlab,
    NULL AS cp_why_now,
    NULL AS cp_score,
    NULL AS cp_use_cases,
    NULL AS competitors,
    NULL AS competitors_other_flag,
    NULL AS competitors_gitlab_core_flag,
    NULL AS competitors_none_flag,
    NULL AS competitors_github_enterprise_flag,
    NULL AS competitors_bitbucket_server_flag,
    NULL AS competitors_unknown_flag,
    NULL AS competitors_github_flag,
    NULL AS competitors_gitlab_flag,
    NULL AS competitors_jenkins_flag,
    NULL AS competitors_azure_devops_flag,
    NULL AS competitors_svn_flag,
    NULL AS competitors_bitbucket_flag,
    NULL AS competitors_atlassian_flag,
    NULL AS competitors_perforce_flag,
    NULL AS competitors_visual_studio_flag,
    NULL AS competitors_azure_flag,
    NULL AS competitors_amazon_code_commit_flag,
    NULL AS competitors_circleci_flag,
    NULL AS competitors_bamboo_flag,
    NULL AS competitors_aws_flag,
    NULL AS created_date,
    NULL AS created_month,
    NULL AS created_fiscal_quarter_date,
    NULL AS created_fiscal_quarter_name,
    NULL AS created_fiscal_year,
    NULL AS sales_accepted_date,
    NULL AS sales_accepted_month,
    NULL AS sales_accepted_fiscal_quarter_date,
    NULL AS sales_accepted_fiscal_quarter_name,
    NULL AS sales_accepted_fiscal_year,
    NULL AS close_date,
    NULL AS close_month,
    NULL AS close_fiscal_quarter_date,
    NULL AS close_fiscal_quarter_name,
    NULL AS close_fiscal_year,
    NULL AS stage_0_pending_acceptance_date,
    NULL AS stage_0_pending_acceptance_month,
    NULL AS stage_0_pending_acceptance_fiscal_quarter_date,
    NULL AS stage_0_pending_acceptance_fiscal_quarter_name,
    NULL AS stage_0_pending_acceptance_fiscal_year,
    NULL AS stage_1_discovery_date,
    NULL AS stage_1_discovery_month,
    NULL AS stage_1_discovery_fiscal_quarter_date,
    NULL AS stage_1_discovery_fiscal_quarter_name,
    NULL AS stage_1_discovery_fiscal_year,
    NULL AS stage_2_scoping_date,
    NULL AS stage_2_scoping_month,
    NULL AS stage_2_scoping_fiscal_quarter_date,
    NULL AS stage_2_scoping_fiscal_quarter_name,
    NULL AS stage_2_scoping_fiscal_year,
    NULL AS stage_3_technical_evaluation_date,
    NULL AS stage_3_technical_evaluation_month,
    NULL AS stage_3_technical_evaluation_fiscal_quarter_date,
    NULL AS stage_3_technical_evaluation_fiscal_quarter_name,
    NULL AS stage_3_technical_evaluation_fiscal_year,
    NULL AS stage_4_proposal_date,
    NULL AS stage_4_proposal_month,
    NULL AS stage_4_proposal_fiscal_quarter_date,
    NULL AS stage_4_proposal_fiscal_quarter_name,
    NULL AS stage_4_proposal_fiscal_year,
    NULL AS stage_5_negotiating_date,
    NULL AS stage_5_negotiating_month,
    NULL AS stage_5_negotiating_fiscal_quarter_date,
    NULL AS stage_5_negotiating_fiscal_quarter_name,
    NULL AS stage_5_negotiating_fiscal_year,
    NULL AS stage_6_awaiting_signature_date,
    NULL AS stage_6_awaiting_signature_date_date,
    NULL AS stage_6_awaiting_signature_date_month,
    NULL AS stage_6_awaiting_signature_date_fiscal_quarter_date,
    NULL AS stage_6_awaiting_signature_date_fiscal_quarter_name,
    NULL AS stage_6_awaiting_signature_date_fiscal_year,
    NULL AS stage_6_closed_won_date,
    NULL AS stage_6_closed_won_month,
    NULL AS stage_6_closed_won_fiscal_quarter_date,
    NULL AS stage_6_closed_won_fiscal_quarter_name,
    NULL AS stage_6_closed_won_fiscal_year,
    NULL AS stage_6_closed_lost_date,
    NULL AS stage_6_closed_lost_month,
    NULL AS stage_6_closed_lost_fiscal_quarter_date,
    NULL AS stage_6_closed_lost_fiscal_quarter_name,
    NULL AS stage_6_closed_lost_fiscal_year,
    NULL AS subscription_start_date,
    NULL AS subscription_start_month,
    NULL AS subscription_start_fiscal_quarter_date,
    NULL AS subscription_start_fiscal_quarter_name,
    NULL AS subscription_start_fiscal_year,
    NULL AS subscription_end_date,
    NULL AS subscription_end_month,
    NULL AS subscription_end_fiscal_quarter_date,
    NULL AS subscription_end_fiscal_quarter_name,
    NULL AS subscription_end_fiscal_year,
    NULL AS sales_qualified_date,
    NULL AS sales_qualified_month,
    NULL AS sales_qualified_fiscal_quarter_date,
    NULL AS sales_qualified_fiscal_quarter_name,
    NULL AS sales_qualified_fiscal_year,
    NULL AS last_activity_date,
    NULL AS last_activity_month,
    NULL AS last_activity_fiscal_quarter_date,
    NULL AS last_activity_fiscal_quarter_name,
    NULL AS last_activity_fiscal_year,
    NULL AS sales_last_activity_date,
    NULL AS sales_last_activity_month,
    NULL AS sales_last_activity_fiscal_quarter_date,
    NULL AS sales_last_activity_fiscal_quarter_name,
    NULL AS sales_last_activity_fiscal_year,
    NULL AS technical_evaluation_date,
    NULL AS technical_evaluation_month,
    NULL AS technical_evaluation_fiscal_quarter_date,
    NULL AS technical_evaluation_fiscal_quarter_name,
    NULL AS technical_evaluation_fiscal_year,
    NULL AS arr_created_date,
    NULL AS arr_created_month,
    NULL AS arr_created_fiscal_quarter_date,
    NULL AS arr_created_fiscal_quarter_name,
    NULL AS arr_created_fiscal_year,
    NULL AS pipeline_created_date,
    NULL AS pipeline_created_month,
    NULL AS pipeline_created_fiscal_quarter_date,
    NULL AS pipeline_created_fiscal_quarter_name,
    NULL AS pipeline_created_fiscal_year,
    NULL AS net_arr_created_date,
    NULL AS net_arr_created_month,
    NULL AS net_arr_created_fiscal_quarter_date,
    NULL AS net_arr_created_fiscal_quarter_name,
    NULL AS net_arr_created_fiscal_year,
    NULL AS snapshot_date,
    NULL AS snapshot_month,
    NULL AS snapshot_fiscal_year,
    NULL AS snapshot_fiscal_quarter_name,
    NULL AS snapshot_fiscal_quarter_date,
    NULL AS snapshot_day_of_fiscal_quarter_normalised,
    NULL AS snapshot_day_of_fiscal_year_normalised,
    NULL AS days_in_0_pending_acceptance,
    NULL AS days_in_1_discovery,
    NULL AS days_in_2_scoping,
    NULL AS days_in_3_technical_evaluation,
    NULL AS days_in_4_proposal,
    NULL AS days_in_5_negotiating,
    NULL AS days_in_sao,
    NULL AS calculated_age_in_days,
    NULL AS days_since_last_activity,
    NULL AS positive_booked_deal_count_in_snapshot_quarter,
    NULL AS positive_booked_net_arr_in_snapshot_quarter,
    NULL AS positive_open_deal_count_in_snapshot_quarter,
    NULL AS positive_open_net_arr_in_snapshot_quarter,
    NULL AS open_1plus_net_arr_in_snapshot_quarter,
    NULL AS open_3plus_net_arr_in_snapshot_quarter,
    NULL AS open_4plus_net_arr_in_snapshot_quarter,
    NULL AS open_1plus_deal_count_in_snapshot_quarter,
    NULL AS open_3plus_deal_count_in_snapshot_quarter,
    NULL AS open_4plus_deal_count_in_snapshot_quarter,
    NULL AS created_arr_in_snapshot_quarter,
    NULL AS closed_won_opps_in_snapshot_quarter,
    NULL AS closed_opps_in_snapshot_quarter,
    NULL AS closed_net_arr_in_snapshot_quarter,
    NULL AS booked_net_arr_in_snapshot_quarter,
    NULL AS created_deals_in_snapshot_quarter,
    NULL AS cycle_time_in_days_in_snapshot_quarter,
    NULL AS booked_deal_count_in_snapshot_quarter,
    NULL AS arr_basis,
    NULL AS opportunity_based_iacv_to_net_arr_ratio,
    NULL AS segment_order_type_iacv_to_net_arr_ratio,
    NULL AS calculated_from_ratio_net_arr,
    NULL AS net_arr,
    NULL AS xdr_net_arr_stage_1,
    NULL AS xdr_net_arr_stage_3,
    NULL AS created_and_won_same_quarter_net_arr,
    NULL AS new_logo_count,
    NULL AS amount,
    NULL AS open_1plus_deal_count,
    NULL AS open_3plus_deal_count,
    NULL AS open_4plus_deal_count,
    NULL AS booked_deal_count,
    NULL AS churned_contraction_deal_count,
    NULL AS open_1plus_net_arr,
    NULL AS open_3plus_net_arr,
    NULL AS open_4plus_net_arr,
    NULL AS booked_net_arr,
    NULL AS churned_contraction_net_arr,
    NULL AS calculated_deal_count,
    NULL AS booked_churned_contraction_deal_count,
    NULL AS booked_churned_contraction_net_arr,
    NULL AS raw_net_arr,
    NULL AS arr,
    NULL AS recurring_amount,
    NULL AS true_up_amount,
    NULL AS proserv_amount,
    NULL AS other_non_recurring_amount,
    NULL AS renewal_amount,
    NULL AS total_contract_value,
    NULL AS created_in_snapshot_quarter_net_arr,
    NULL AS created_in_snapshot_quarter_deal_count,
    NULL AS days_in_stage,
    NULL AS pre_military_invasion_arr,
    NULL AS vsa_start_date_net_arr,
    NULL AS won_arr_basis_for_clari,
    NULL AS arr_basis_for_clari,
    NULL AS net_incremental_acv,
    NULL AS incremental_acv,
    NULL AS forecasted_churn_for_clari,
    NULL AS override_arr_basis_clari,
    NULL AS cycle_time_in_days,
    NULL AS ptc_predicted_arr,
    NULL AS ptc_predicted_renewal_risk_category,
    'targets_actuals' AS source,
    total_quarter_target,
    coverage_booked_net_arr,
    coverage_open_1plus_net_arr,
    coverage_open_3plus_net_arr,
    coverage_open_4plus_net_arr,
    total_booked_net_arr
  FROM targets_actuals



) #}
