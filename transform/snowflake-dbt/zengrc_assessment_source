[0m13:16:58  Running with dbt=1.2.3
[0m13:17:01  Found 2505 models, 4725 tests, 87 snapshots, 8 analyses, 703 macros, 5 operations, 50 seed files, 910 sources, 6 exposures, 0 metrics
[0m13:17:01  
[0m13:17:57  Encountered an error:
Database Error
  003540 (42501): SQL execution error: Creating schema on shared database 'SNOWFLAKE' is not allowed.
[0m13:17:57  Traceback (most recent call last):
  File "/Users/snehanshchaturvedi/Library/Caches/pypoetry/virtualenvs/analytics-v4qhpGhz-py3.10/lib/python3.10/site-packages/dbt/adapters/snowflake/connections.py", line 222, in exception_handler
    yield
  File "/Users/snehanshchaturvedi/Library/Caches/pypoetry/virtualenvs/analytics-v4qhpGhz-py3.10/lib/python3.10/site-packages/dbt/adapters/sql/connections.py", line 70, in add_query
    cursor.execute(sql, bindings)
  File "/Users/snehanshchaturvedi/Library/Caches/pypoetry/virtualenvs/analytics-v4qhpGhz-py3.10/lib/python3.10/site-packages/snowflake/connector/cursor.py", line 804, in execute
    Error.errorhandler_wrapper(self.connection, self, error_class, errvalue)
  File "/Users/snehanshchaturvedi/Library/Caches/pypoetry/virtualenvs/analytics-v4qhpGhz-py3.10/lib/python3.10/site-packages/snowflake/connector/errors.py", line 276, in errorhandler_wrapper
    handed_over = Error.hand_to_other_handler(
  File "/Users/snehanshchaturvedi/Library/Caches/pypoetry/virtualenvs/analytics-v4qhpGhz-py3.10/lib/python3.10/site-packages/snowflake/connector/errors.py", line 331, in hand_to_other_handler
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/Users/snehanshchaturvedi/Library/Caches/pypoetry/virtualenvs/analytics-v4qhpGhz-py3.10/lib/python3.10/site-packages/snowflake/connector/errors.py", line 210, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 003540 (42501): SQL execution error: Creating schema on shared database 'SNOWFLAKE' is not allowed.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/snehanshchaturvedi/Library/Caches/pypoetry/virtualenvs/analytics-v4qhpGhz-py3.10/lib/python3.10/site-packages/dbt/main.py", line 129, in main
    results, succeeded = handle_and_check(args)
  File "/Users/snehanshchaturvedi/Library/Caches/pypoetry/virtualenvs/analytics-v4qhpGhz-py3.10/lib/python3.10/site-packages/dbt/main.py", line 191, in handle_and_check
    task, res = run_from_args(parsed)
  File "/Users/snehanshchaturvedi/Library/Caches/pypoetry/virtualenvs/analytics-v4qhpGhz-py3.10/lib/python3.10/site-packages/dbt/main.py", line 238, in run_from_args
    results = task.run()
  File "/Users/snehanshchaturvedi/Library/Caches/pypoetry/virtualenvs/analytics-v4qhpGhz-py3.10/lib/python3.10/site-packages/dbt/task/runnable.py", line 470, in run
    result = self.execute_with_hooks(selected_uids)
  File "/Users/snehanshchaturvedi/Library/Caches/pypoetry/virtualenvs/analytics-v4qhpGhz-py3.10/lib/python3.10/site-packages/dbt/task/runnable.py", line 432, in execute_with_hooks
    self.before_run(adapter, selected_uids)
  File "/Users/snehanshchaturvedi/Library/Caches/pypoetry/virtualenvs/analytics-v4qhpGhz-py3.10/lib/python3.10/site-packages/dbt/task/run.py", line 442, in before_run
    self.create_schemas(adapter, required_schemas)
  File "/Users/snehanshchaturvedi/Library/Caches/pypoetry/virtualenvs/analytics-v4qhpGhz-py3.10/lib/python3.10/site-packages/dbt/task/runnable.py", line 576, in create_schemas
    create_future.result()
  File "/Library/Frameworks/Python.framework/Versions/3.10/lib/python3.10/concurrent/futures/_base.py", line 439, in result
    return self.__get_result()
  File "/Library/Frameworks/Python.framework/Versions/3.10/lib/python3.10/concurrent/futures/_base.py", line 391, in __get_result
    raise self._exception
  File "/Library/Frameworks/Python.framework/Versions/3.10/lib/python3.10/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/snehanshchaturvedi/Library/Caches/pypoetry/virtualenvs/analytics-v4qhpGhz-py3.10/lib/python3.10/site-packages/dbt/utils.py", line 480, in connected
    return func(*args, **kwargs)
  File "/Users/snehanshchaturvedi/Library/Caches/pypoetry/virtualenvs/analytics-v4qhpGhz-py3.10/lib/python3.10/site-packages/dbt/task/runnable.py", line 540, in create_schema
    adapter.create_schema(relation)
  File "/Users/snehanshchaturvedi/Library/Caches/pypoetry/virtualenvs/analytics-v4qhpGhz-py3.10/lib/python3.10/site-packages/dbt/adapters/sql/impl.py", line 162, in create_schema
    self.execute_macro(CREATE_SCHEMA_MACRO_NAME, kwargs=kwargs)
  File "/Users/snehanshchaturvedi/Library/Caches/pypoetry/virtualenvs/analytics-v4qhpGhz-py3.10/lib/python3.10/site-packages/dbt/adapters/base/impl.py", line 976, in execute_macro
    result = macro_function(**kwargs)
  File "/Users/snehanshchaturvedi/Library/Caches/pypoetry/virtualenvs/analytics-v4qhpGhz-py3.10/lib/python3.10/site-packages/dbt/clients/jinja.py", line 321, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/snehanshchaturvedi/Library/Caches/pypoetry/virtualenvs/analytics-v4qhpGhz-py3.10/lib/python3.10/site-packages/dbt/clients/jinja.py", line 248, in call_macro
    return macro(*args, **kwargs)
  File "/Users/snehanshchaturvedi/Library/Caches/pypoetry/virtualenvs/analytics-v4qhpGhz-py3.10/lib/python3.10/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/snehanshchaturvedi/Library/Caches/pypoetry/virtualenvs/analytics-v4qhpGhz-py3.10/lib/python3.10/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 19, in macro
  File "/Users/snehanshchaturvedi/Library/Caches/pypoetry/virtualenvs/analytics-v4qhpGhz-py3.10/lib/python3.10/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/snehanshchaturvedi/Library/Caches/pypoetry/virtualenvs/analytics-v4qhpGhz-py3.10/lib/python3.10/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/snehanshchaturvedi/Library/Caches/pypoetry/virtualenvs/analytics-v4qhpGhz-py3.10/lib/python3.10/site-packages/dbt/clients/jinja.py", line 321, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/snehanshchaturvedi/Library/Caches/pypoetry/virtualenvs/analytics-v4qhpGhz-py3.10/lib/python3.10/site-packages/dbt/clients/jinja.py", line 248, in call_macro
    return macro(*args, **kwargs)
  File "/Users/snehanshchaturvedi/Library/Caches/pypoetry/virtualenvs/analytics-v4qhpGhz-py3.10/lib/python3.10/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/snehanshchaturvedi/Library/Caches/pypoetry/virtualenvs/analytics-v4qhpGhz-py3.10/lib/python3.10/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 28, in macro
  File "/Users/snehanshchaturvedi/Library/Caches/pypoetry/virtualenvs/analytics-v4qhpGhz-py3.10/lib/python3.10/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/snehanshchaturvedi/Library/Caches/pypoetry/virtualenvs/analytics-v4qhpGhz-py3.10/lib/python3.10/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/snehanshchaturvedi/Library/Caches/pypoetry/virtualenvs/analytics-v4qhpGhz-py3.10/lib/python3.10/site-packages/dbt/clients/jinja.py", line 321, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/snehanshchaturvedi/Library/Caches/pypoetry/virtualenvs/analytics-v4qhpGhz-py3.10/lib/python3.10/site-packages/dbt/clients/jinja.py", line 248, in call_macro
    return macro(*args, **kwargs)
  File "/Users/snehanshchaturvedi/Library/Caches/pypoetry/virtualenvs/analytics-v4qhpGhz-py3.10/lib/python3.10/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/snehanshchaturvedi/Library/Caches/pypoetry/virtualenvs/analytics-v4qhpGhz-py3.10/lib/python3.10/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/snehanshchaturvedi/Library/Caches/pypoetry/virtualenvs/analytics-v4qhpGhz-py3.10/lib/python3.10/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/snehanshchaturvedi/Library/Caches/pypoetry/virtualenvs/analytics-v4qhpGhz-py3.10/lib/python3.10/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/snehanshchaturvedi/Library/Caches/pypoetry/virtualenvs/analytics-v4qhpGhz-py3.10/lib/python3.10/site-packages/dbt/adapters/base/impl.py", line 242, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch)
  File "/Users/snehanshchaturvedi/Library/Caches/pypoetry/virtualenvs/analytics-v4qhpGhz-py3.10/lib/python3.10/site-packages/dbt/adapters/snowflake/connections.py", line 441, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/snehanshchaturvedi/Library/Caches/pypoetry/virtualenvs/analytics-v4qhpGhz-py3.10/lib/python3.10/site-packages/dbt/adapters/snowflake/connections.py", line 492, in add_query
    connection, cursor = super().add_query(
  File "/Users/snehanshchaturvedi/Library/Caches/pypoetry/virtualenvs/analytics-v4qhpGhz-py3.10/lib/python3.10/site-packages/dbt/adapters/sql/connections.py", line 60, in add_query
    with self.exception_handler(sql):
  File "/Library/Frameworks/Python.framework/Versions/3.10/lib/python3.10/contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/Users/snehanshchaturvedi/Library/Caches/pypoetry/virtualenvs/analytics-v4qhpGhz-py3.10/lib/python3.10/site-packages/dbt/adapters/snowflake/connections.py", line 241, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error
  003540 (42501): SQL execution error: Creating schema on shared database 'SNOWFLAKE' is not allowed.

