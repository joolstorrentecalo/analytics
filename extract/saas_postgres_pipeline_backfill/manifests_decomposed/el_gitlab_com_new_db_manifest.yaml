connection_info:
  postgres_source_connection:
    database: GITLAB_COM_DB_NAME
    host: GITLAB_COM_DB_HOST
    pass: GITLAB_COM_DB_PASS
    port: GITLAB_COM_PG_PORT
    user: GITLAB_COM_DB_USER
  postgres_metadata_connection:
    database: GITLAB_METADATA_DB_NAME
    host: GITLAB_METADATA_DB_HOST
    pass: GITLAB_METADATA_DB_PASS
    port: GITLAB_METADATA_PG_PORT
    user: GITLAB_METADATA_DB_USER
tables:
  merge_request_diff_commits:
    dbt_source_model: true
    export_schema: 'gitlab_com'
    export_table: 'merge_request_diff_commits'
    export_table_primary_key: merge_request_diff_id # real PK is composite key fyi
    import_db: GITLAB_DB
    import_query: |-
      SELECT authored_date
      , committed_date
      , merge_request_diff_id
      , relative_order
      , sha
      , commit_author_id
      , committer_id
      FROM merge_request_diff_commits
      WHERE committed_date BETWEEN '{BEGIN_TIMESTAMP}'::timestamp
        AND '{END_TIMESTAMP}'::timestamp
  alert_management_alerts:
    dbt_source_model: true
    export_schema: 'gitlab_com'
    export_table: 'alert_management_alerts'
    export_table_primary_key: id
    import_db: GITLAB_DB
    import_query: |-
      SELECT id
      , created_at
      , updated_at
      , started_at
      , ended_at
      , events
      , iid
      , status
      , issue_id
      , project_id
      FROM alert_management_alerts
      WHERE updated_at BETWEEN '{BEGIN_TIMESTAMP}'::timestamp
        AND '{END_TIMESTAMP}'::timestamp
